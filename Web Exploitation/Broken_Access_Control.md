# Cybersecurity (Web Exploitation)
Author: Kanishk Jagya  
GitHub: [github.com/KanishkJagya1](https://github.com/KanishkJagya1)

## Table of Contents
1. [Introduction](#introduction)
2. [Broken Access Control](#broken-access-control)
    - [Understanding Access Control](#understanding-access-control)
    - [Broken Access Control in Action](#broken-access-control-in-action)
    - [Example: Insecure Direct Object References (IDOR)](#example-insecure-direct-object-references-idor)
    - [Example: Forced Browsing](#example-forced-browsing)
    - [Exploiting via Burp Suite](#exploiting-via-burp-suite)
    - [Preventing Broken Access Control](#preventing-broken-access-control)
    - [Example in a CTF Scenario](#example-in-a-ctf-scenario)
3. [Conclusion](#conclusion)

## Introduction
This repository provides a detailed explanation of Broken Access Control, a common web security vulnerability, along with example code snippets and mitigation strategies. The content is particularly useful for Capture The Flag (CTF) challenges and practical web security.

## Broken Access Control
Broken Access Control is a critical web security vulnerability that occurs when an application does not properly enforce restrictions on what authenticated users are allowed to do. This can lead to unauthorized access to sensitive information and actions that should be restricted.

### Understanding Access Control
Access control, also known as authorization, is the mechanism that determines what actions a user can perform and what resources they can access. Proper access control ensures that users can only access resources and perform actions that they are permitted to.

### Broken Access Control in Action
#### Example: Insecure Direct Object References (IDOR)
Insecure Direct Object References (IDOR) occur when an application exposes a reference to an internal object, such as a file or database key, without proper access control. This can allow an attacker to manipulate the reference to access unauthorized resources.

```javascript
// Example: Insecure Direct Object Reference (IDOR)
app.get('/viewProfile', (req, res) => {
    let userId = req.query.userId;
    let userProfile = getUserProfile(userId);
    res.send(userProfile);
});
```

In this example, an attacker can manipulate the `userId` parameter to view another user's profile:

```
http://example.com/viewProfile?userId=123
```

By changing the `userId` value, the attacker can access profiles of other users:

```
http://example.com/viewProfile?userId=124
```

#### Example: Forced Browsing
Forced browsing occurs when an attacker is able to access unauthorized pages or resources by simply browsing to them directly. This often happens because the application does not properly restrict access to certain URLs.

```javascript
// Example: Forced Browsing
app.get('/admin', (req, res) => {
    if (req.user && req.user.role === 'admin') {
        res.send('Welcome to the admin panel');
    } else {
        res.status(403).send('Forbidden');
    }
});
```

If the application does not properly restrict access to the `/admin` URL, an attacker might be able to access the admin panel directly:

```
http://example.com/admin
```

### Exploiting via Burp Suite
Burp Suite is a powerful tool for testing web security vulnerabilities, including Broken Access Control. Here’s how you can use Burp Suite to exploit such vulnerabilities:

1. **Identify Vulnerable Endpoints**: Use Burp Suite's proxy to intercept and analyze HTTP requests and responses. Look for endpoints that might be vulnerable to IDOR or forced browsing.
2. **Modify Requests**: Manipulate parameters and URLs to see if you can access unauthorized resources.
3. **Analyze Responses**: Check the server responses to determine if you have successfully accessed restricted data or functionalities.

### Preventing Broken Access Control
To protect against Broken Access Control vulnerabilities, consider the following best practices:

1. **Implement Proper Access Controls**: Ensure that access controls are enforced server-side for all sensitive operations and resources.
2. **Use Indirect References**: Avoid exposing direct references to internal objects. Instead, use indirect references that map to the actual objects server-side.
3. **Validate User Permissions**: Always check that the user has the necessary permissions to access a resource or perform an action.
4. **Role-Based Access Control (RBAC)**: Implement RBAC to define roles and assign permissions based on these roles.
5. **Regular Security Audits**: Conduct regular security audits and penetration testing to identify and fix access control vulnerabilities.

### Example in a CTF Scenario
In a Capture The Flag (CTF) scenario, you might be given a web application with endpoints that lack proper access control. Your task would be to exploit these endpoints to access sensitive information or functionalities, revealing the flag.

Here’s a step-by-step approach:

1. **Identify Vulnerable Endpoints**: Use tools like Burp Suite to find endpoints that expose direct references to internal objects or lack proper access restrictions.
2. **Craft a Malicious Request**: Modify the parameters or URLs to access unauthorized resources (e.g., changing `userId` to another user's ID).
3. **Extract the Response**: Analyze the server response to extract sensitive information or the flag.

## Conclusion
Broken Access Control is a serious vulnerability that can lead to unauthorized access and significant security breaches. By understanding how access controls work and how these vulnerabilities can be exploited, developers can better protect their applications. Always validate user permissions, avoid exposing direct references to internal objects, and enforce access controls server-side.